{% extends 'base.html' %}

{% block title %}Мій профіль - SchoolHub{% endblock %}

{% block content %}
<div class="row">
    <!-- Картка з інформацією про користувача -->
    <div class="col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <img src="{{ user.profile.avatar.url|default:'https://via.placeholder.com/150' }}"
                     alt="Avatar"
                     class="rounded-circle img-fluid mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                <h4 class="my-3">{{ user.get_full_name }}</h4>
                <p class="text-muted mb-1">@{{ user.username }}</p>
                <p class="text-muted mb-2">{{ user.email }}</p>
                {% if user.profile.class_room %}
                    <p class="text-muted mb-4">Клас: <strong>{{ user.profile.class_room }}</strong></p>
                {% endif %}
                {% for pos in user.profile.positions.all %}
                    <span class="badge bg-info text-dark">{{ pos.name }}</span>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Форма редагування -->
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body p-4">
                <h4 class="mb-4">Редагування профілю</h4>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <h5 class="text-muted mb-3">Обліковий запис</h5>
                    {% for field in user_form %}
                        {# Приховуємо поля паролів, оскільки це сторінка редагування, а не створення #}
                        {% if field.name != 'password1' and field.name != 'password2' %}
                            <div class="mb-3">
                                <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                                {{ field.as_widget(attrs={'class': 'form-control'}) }}
                            </div>
                        {% endif %}
                    {% endfor %}

                    <hr class="my-4">
                    <h5 class="text-muted mb-3">Додаткова інформація</h5>
                    {% for field in profile_form %}
                        <div class="mb-3">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                            {{ field.as_widget(attrs={'class': 'form-control', 'rows': 3}) }}
                        </div>
                    {% endfor %}

                    <button type="submit" class="btn btn-primary mt-3">Зберегти зміни</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}